# ะัะพะณะฝะพะทะธัะพะฒะฐะฝะธะต ะดะพัะพะดะพะฒ ะบะปะธะตะฝัะพะฒ ะะปััะฐ-ะะฐะฝะบ

**ะะธะฑัะธะดะฝะฐั AI-ะผะพะดะตะปั**: FT-Transformer (ัะผะฑะตะดะดะธะฝะณะธ) + CatBoost (ะฟัะตะดัะบะฐะทะฐะฝะธะต)

**ะกะฐะนั ั ะผะพะดะตะปัั ะดะพัััะฟะตะฝ ะฟะพ ัััะปะบะต:** https://0fe4fbb153e280.lhr.life

## ๐ก ะะปััะตะฒะฐั ะธะดะตั

**Two-stage ะฟะพะดัะพะด** ัะตัะฐะตั ะฟัะพะฑะปะตะผั ะฟะตัะตะพะฑััะตะฝะธั ััะฐะฝััะพัะผะตัะฐ:

1. **FT-Transformer** ะธะทะฒะปะตะบะฐะตั ะณะปัะฑะพะบะธะต ัะผะฑะตะดะดะธะฝะณะธ (192-dim) ะทะฐ 20 ัะฟะพั ั ัะตะณัะปััะธะทะฐัะธะตะน
2. **CatBoost** ัััะพะธั ัะธะฝะฐะปัะฝะพะต ะฟัะตะดัะบะฐะทะฐะฝะธะต ะฝะฐ ัะผะฑะตะดะดะธะฝะณะฐั + ะธััะพะดะฝัั ะฟัะธะทะฝะฐะบะฐั

## ๐ ะัััััะน ััะฐัั

### 1. ะฃััะฐะฝะพะฒะบะฐ

```bash
cd hakaton_alpha
python -m venv venv
source venv/bin/activate  # Linux/macOS
# ะธะปะธ venv\Scripts\activate ะดะปั Windows

pip install -r requirements.txt
```

### 2. ะะฑััะตะฝะธะต ะธ ะฟัะพะฒะตัะบะฐ ะบะฐัะตััะฒะฐ

```bash
chmod +x train.sh
./train.sh
```

ะกะบัะธะฟั ะพะฑััะธั ะณะธะฑัะธะดะฝัั ะผะพะดะตะปั (~20-35 ะผะธะฝัั) ะธ ะฟะพะบะฐะถะตั ัะธะฝะฐะปัะฝัั ะผะตััะธะบั WMAE.

**ะะตะทัะปััะฐั:**

- `hybrid_model.cbm` - CatBoost ะผะพะดะตะปั
- `hybrid_model_embedder.pth` - FT-Transformer embedder
- `submission_hybrid.csv` - ัะฐะนะป ะดะปั ะพัะฟัะฐะฒะบะธ ะฝะฐ ะปะธะดะตัะฑะพัะด

### 3. ะะตะฑ-ะธะฝัะตััะตะนั

```bash
./start_tunnel.sh
```

## ๐ ะคะฐะนะปั ะฟัะพะตะบัะฐ

- `model.py` - ะััะธัะตะบัััะฐ FT-Transformer
- `train_hybrid.py` - ะะฑััะตะฝะธะต ะณะธะฑัะธะดะฝะพะน ะผะพะดะตะปะธ
- `app.py` - Flask ะฒะตะฑ-ะฟัะธะปะพะถะตะฝะธะต
- `quick_train.sh` - ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑััะตะฝะธะต
- `requirements.txt` - ะะฐะฒะธัะธะผะพััะธ

## ๐๏ธ ะััะธัะตะบัััะฐ ะณะธะฑัะธะดะฝะพะน ะผะพะดะตะปะธ

```
Input Features (216 ะฟัะธะทะฝะฐะบะพะฒ)
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ะญะขะะ 1: FT-Transformer Embedder   โ
โ   (20 ัะฟะพั ั ัะตะณัะปััะธะทะฐัะธะตะน)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
Feature Tokenization
    โโโ ะงะธัะปะพะฒัะต (206): Linear + Bias
    โโโ ะะฐัะตะณะพัะธะฐะปัะฝัะต (10): Embedding
    โ
Transformer Encoder (3 ัะปะพั ร 8 heads)
    โโโ Multi-Head Self-Attention
    โโโ FFN (512)
    โโโ Dropout 0.2
    โโโ Layer Norm
    โ
[CLS] Token โ Embeddings (192-dim)
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ะญะขะะ 2: CatBoost Regressor        โ
โ   (2000 ะธัะตัะฐัะธะน)                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
Concatenate:
  โข ะััะพะดะฝัะต ะฟัะธะทะฝะฐะบะธ (206)
  โข ะญะผะฑะตะดะดะธะฝะณะธ (192)
  โ ะัะพะณะพ: 398 ะฟัะธะทะฝะฐะบะพะฒ
    โ
Gradient Boosting
    โ
Predicted Income
```

## ๐ ะะฐัะฐะผะตััั ะพะฑััะตะฝะธั

```bash
python train_hybrid.py \
    --transformer_epochs 20 \   # ะญะฟะพั ะดะปั ััะฐะฝััะพัะผะตัะฐ
    --batch_size 256 \          # ะะฐะทะผะตั ะฑะฐััะฐ
    --learning_rate 1e-4 \      # ะกะบะพัะพััั ะพะฑััะตะฝะธั
    --d_token 192 \             # ะะฐะทะผะตัะฝะพััั ัะผะฑะตะดะดะธะฝะณะพะฒ
    --n_layers 3 \              # ะกะปะพะธ ััะฐะฝััะพัะผะตัะฐ
    --n_heads 8                 # Attention heads
```

**ะะปั CPU:**

```bash
python train_hybrid.py --transformer_epochs 20 --batch_size 128 --cpu
```
